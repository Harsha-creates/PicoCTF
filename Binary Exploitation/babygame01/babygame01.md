### Description

Get the flag and reach the exit.

Additional details will be available after launching your challenge instance.

## Start the Instance

Get the flag and reach the exit.

Welcome to BabyGame! Navigate around the map and see what you can find! The game is available to download [here](./game). There is no source available, so you'll have to figure your way around the map. You can connect with it using `nc saturn.picoctf.net 62498`

### Approach 

Open downloaded game: `./game`

>`bash: ./game: Permission denied`
change the permission for the file: `chmod +x game`

Now again open the game: `./game` 
Move to End tile position `29,89` by using w,s,a,d keys:

![image](https://github.com/Harsha-creates/PicoCTF/assets/68886253/f22431f2-4217-4c50-ac9a-e81c0d89d3e9)

![image](https://github.com/Harsha-creates/PicoCTF/assets/68886253/d3f56249-377a-4e3c-9fbe-ce82b814bc05)

But we didn't get the flag.

Load this into [Ghidra](https://ghidra-sre.org/), which is a reverse engineering tool. You need to have JAVA SDK installed because its written un Java.

Unfortunately, Ghidra is not working on my system. However, we can use Ghidra Online from this [site](https://dogbolt.org/?id=3b1456fc-43f7-41df-ac31-a4db11e832d2).

```java
local_10 = &stack0x00000004;
  local_14 = *(int *)(in_GS_OFFSET + 0x14);
  init_player(&local_aac);
  init_map(local_aa0,&local_aac);
  print_map(local_aa0,&local_aac);
  signal(2,sigint_handler);
  do {
    do {
      iVar1 = getchar();
      move_player(&local_aac,(int)(char)iVar1,local_aa0);
      print_map(local_aa0,&local_aac);
    } while (local_aac != 0x1d);
  } while (local_aa8 != 0x59);
  puts("You win!");
  if (local_aa4 != '\0') {
    puts("flage");
    win();
    fflush(_stdout);
  }
  uVar2 = 0;
  if (local_14 != *(int *)(in_GS_OFFSET + 0x14)) {
    uVar2 = __stack_chk_fail_local();
  }
  return uVar2;
}
```

`local_aa4` variable is responsible to get the flag. but, it must not be zero[`(local_aa4 != '\0')`] and I tried every other position and no flag. 
I thought what if the flag is outside the map, by chance i got the flag when the `@` is moved 4 places to the left of point (0,0).

![image](https://github.com/Harsha-creates/PicoCTF/assets/68886253/62eea2c3-380f-4f43-801c-996e41993b83)

Now that I got the flag all we need to do to move to End tile position. we can do that with `p`.[`(param_2 == 'p')`] from this block of code.

```java
void move_player(int *param_1,char param_2,int param_3)

{
  int iVar1;
  
  if (param_2 == 'l') {
    iVar1 = getchar();
    player_tile = (undefined)iVar1;
  }
  if (param_2 == 'p') {
    solve_round(param_3,param_1);
  }
  *(undefined *)(*param_1 * 0x5a + param_3 + param_1[1]) = 0x2e;
  if (param_2 == 'w') {
    *param_1 = *param_1 + -1;
  }
  else if (param_2 == 's') {
    *param_1 = *param_1 + 1;
  }
  else if (param_2 == 'a') {
    param_1[1] = param_1[1] + -1;
  }
  else if (param_2 == 'd') {
    param_1[1] = param_1[1] + 1;
  }
  *(undefined *)(*param_1 * 0x5a + param_3 + param_1[1]) = player_tile;
  return;
}
```

![image](https://github.com/Harsha-creates/PicoCTF/assets/68886253/1528bdbc-b94d-48d6-9184-ac83a3a6f7fa)

`flag.txt not found in current directory` didn't get the flag because I did it in locally.

`nc saturn.picoctf.net 53685`

![image](https://github.com/Harsha-creates/PicoCTF/assets/68886253/e387de42-6260-4163-bb07-e651a821e34d)

**Flag:** `picoCTF{gamer_m0d3_enabled_8985ce0e}`
